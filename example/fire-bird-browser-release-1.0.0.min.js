var FIREBIRD=function(){"use strict";var t=void 0!==typeof self?self:this,e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,n)};function n(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}var i=function(){return(i=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function r(t,e,n){if(n||2===arguments.length)for(var i,r=0,o=e.length;r<o;r++)!i&&r in e||(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}"function"==typeof SuppressedError&&SuppressedError;var o=Object.prototype.toString;function s(t){return function(e){return o.call(e)==="[object ".concat(t,"]")}}var a={isNumber:s("Number"),isString:s("String"),isBoolean:s("Boolean"),isNull:s("Null"),isUndefined:s("Undefined"),isSymbol:s("Symbol"),isFunction:s("Function"),isObject:s("Object"),isArray:s("Array"),isProcess:s("process"),isWindow:s("Window")};function c(t){return a.isString(t)&&""===t.trim()||null==t}var u=a.isProcess("undefined"!=typeof process?process:0),h=a.isObject("undefined"!=typeof wx?wx:0)&&a.isFunction("undefined"!=typeof App?App:0),p=a.isObject("undefined"!=typeof my?my:0)&&a.isFunction("undefined"!=typeof App?App:0);var l=a.isWindow("undefined"!=typeof window?window:0)?window:h?wx:p?my:u?process:void 0,f=(l.__FIREBIRD__=l.__FIREBIRD__||{},l.__FIREBIRD__);var d="[FIREBIRD]",y=function(){function t(){var t=this;if(this.enabled=!1,this._console={},l.console=console||l.console,console||l.console){["log","debug","info","warn","error","assert"].forEach((function(e){e in l.console&&(t._console[e]=l.console[e])}))}}return t.prototype.disable=function(){this.enabled=!1},t.prototype.bindOptions=function(t){this.enabled=!!t},t.prototype.enable=function(){this.enabled=!0},t.prototype.getEnableStatus=function(){return this.enabled},t.prototype.log=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.enabled&&(t=this._console).log.apply(t,r(["".concat(d,"[Log]:")],e,!1))},t.prototype.warn=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.enabled&&(t=this._console).warn.apply(t,r(["".concat(d,"[Warn]:")],e,!1))},t.prototype.error=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];(t=this._console).error.apply(t,r(["".concat(d,"[Error]:")],e,!1))},t}(),v=f.logger||(f.logger=new y);function m(t,e,n){return!!function(t,e){return o.call(t)==="[object ".concat(e,"]")}(t,n)||(void 0!==t&&v.error("".concat(e,"期望传入:").concat(n,"类型，当前是:").concat(o.call(t),"类型")),!1)}function g(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)}))}function _(t){var e=this;t.forEach((function(t){var n=t[0],i=t[1];return m(n,i,t[2])&&(e[i]=n)}))}function w(t){var e=[],n=function(n){if(t.hasOwnProperty(n)){var i=t[n];Array.isArray(i)?i.forEach((function(t){e.push("".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(t)))})):e.push("".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(i)))}};for(var i in t)n(i);return e.join("&")}var S,b=function(){function t(t){this.capacity=t||50,this.headPoint=0,this.tailPoint=0,this.length=0,this.queue=[]}return t.prototype.clear=function(){this.headPoint=0,this.tailPoint=0,this.length=0,this.queue=[]},t.prototype.destroy=function(){this.queue=null},t.prototype.push=function(t){if(!this.isFull())return this.queue.push(t),this.length=this.queue.length,this.tailPoint=++this.tailPoint%this.capacity,this.length},t.prototype.unshift=function(t){if(!this.isFull())return this.queue.unshift(t),this.length=this.queue.length,this.tailPoint=++this.tailPoint%this.capacity,this.length},t.prototype.shift=function(){this.isEmpty()||(this.queue.shift(),this.length=this.queue.length,this.headPoint=++this.headPoint%this.capacity)},t.prototype.deleteForTcpId=function(t){this.queue=this.queue.filter((function(e){return e.tcpId!==t}))},t.prototype.refreshStatusForTcpId=function(t,e){this.queue=this.queue.map((function(n){return n.tcpId===t&&(n.reportStatus=e),n}))},t.prototype.deleteIndex=function(t,e){void 0===e&&(e=1),this.isEmpty()||(this.queue.splice(t,e),this.length=this.queue.length,this.headPoint=++this.headPoint%this.capacity)},t.prototype.isFull=function(){return this.length===this.capacity},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.travel=function(t){for(var e=0;e<this.length+this.headPoint;e++)t&&t(this.queue[e%this.capacity])},t.prototype.getQueue=function(){return this.queue},t.prototype.setQueue=function(t){this.queue=r([],t,!0),this.length=this.queue.length},t.prototype.loadQueue=function(t){this.queue=t,this.length=t.length,this.headPoint=0,this.tailPoint=t.length%this.capacity},t}(),I=function(){function t(){this.stack=[],this.isFlushing=!1,this.micro=Promise.resolve()}return t.prototype.addTask=function(t){var e=this;"function"==typeof t&&(this.stack.push(t),this.isFlushing||(this.isFlushing=!0,this.micro.then((function(){return e.flushStack()}))))},t.prototype.clear=function(){this.stack=[]},t.prototype.getStack=function(){return this.stack},t.prototype.flushStack=function(){var t=this.stack.slice(0);this.stack.length=0,this.isFlushing=!1;for(var e=0,n=t;e<n.length;e++){(0,n[e])()}},t}();!function(t){t.Else="else",t.Error="error",t.Warning="warning",t.Info="info",t.Debug="debug",t.Low="low",t.Normal="normal",t.High="high",t.Critical="critical"}(S||(S={})),function(t){t.fromString=function(e){switch(e){case"debug":return t.Debug;case"info":case"log":case"assert":return t.Info;case"warn":case"warning":return t.Warning;case t.Low:case t.Normal:case t.High:case t.Critical:case"error":return t.Error;default:return t.Else}}}(S||(S={}));var k=function(){function t(t){this.options=t,v.bindOptions(!!t.debug)}return t.prototype.getOptions=function(){return this.options},t}(),x=function(){function t(){this.disabled=!1,this.appKey="",this.deviceId="",this.channel="",this.appUserId="",this.salt="",this.scene="",this.host="",this.envType="",this.debug=!1}return t.prototype.bindOptions=function(t){var e=t.disabled,n=t.appKey,i=t.deviceId,r=t.channel,o=t.appUserId,s=t.salt,a=t.scene,c=t.host,u=t.envType,h=t.debug,p=[[e,"disabled","String"],[n,"appKey","String"],[i,"deviceId","String"],[r,"channel","String"],[o,"appUserId","String"],[s,"salt","String"],["".concat(a),"scene","String"],[c,"host","String"],[u,"envType","String"],[h,"debug","String"]];_.call(this,p)},t}(),T=function(){function t(){this.appKey="",this.salt="",this.host="",this.deviceId="",this.scene="",this.appUserId="",this.beforeDataReport=null,this.queue=new I}return t.prototype.bindOptions=function(t){void 0===t&&(t={});var e=t.host,n=t.beforeDataReport,i=t.appKey,r=t.salt,o=t.deviceId,s=t.scene,a=t.appUserId,c=[[i,"appKey","String"],[r,"salt","String"],[e,"host","String"],[o,"deviceId","String"],["".concat(s),"scene","String"],[a,"appUserId","String"],[n,"beforeDataReport","Function"]];_.call(this,c)},t.prototype.getBaseData=function(){return{app_key:this.appKey,sdk_version:"",sdk_name:"",device_id:this.deviceId,timestamp:Date.now()}},t.prototype.setAuthInfo=function(t){this.authInfo=t},t.prototype.send=function(t,e){var n=this.host+e;if(!c(n))return this.sendToServer(t,n);v.error("host is empty,pass in when initializing please")},t}(),E=function(){function t(){this.events=new Map}return t.prototype.on=function(t,e){var n=this.events.get(t)||[];return n.push(e),this.events.set(t,n),this},t.prototype.emit=function(t){for(var e=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];if(!this.events.has(t))return!1;var r=this.events.get(t)||[];return r.forEach((function(t){return t.apply(e,n)})),!0},t.prototype.remove=function(t,e){var n=(this.events.get(t)||[]).filter((function(t){return t!==e}));return this.events.set(t,n),this},t.prototype.removeAll=function(t){return this.events.delete(t),this},t.prototype.once=function(t,e){var n=this,i=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];e.apply(n,r),n.remove(t,i)};return this.on(t,i)},t}(),O="".concat("FIRE_BIRD_","DEVICE_ID"),R="".concat("FIRE_BIRD_","APP_USER_ID"),B="".concat("FIRE_BIRD_","AUTH_INFO"),F="".concat("FIRE_BIRD_","QUEUE"),A="".concat("FIRE_BIRD_","CACHE_END"),C="".concat("FIRE_BIRD_","EVENT_STACK"),D="/app/init",Q="/app/i",P=function(t,e){void 0===e&&(e="object");var n=localStorage.getItem(t)||{object:"{}",string:'""',array:"[]"}[e];try{return JSON.parse(n)}catch(t){return console.error("getItemSync",t),null}},U=function(t,e){try{return localStorage.setItem(t,JSON.stringify(e)),e}catch(t){return console.error("setItemSync",t),null}},q=function(t){try{var e=localStorage.getItem(t);return JSON.parse(e)}catch(t){return console.error("getOriginSync",t),null}},j=function(){function t(t){void 0===t&&(t={}),this.maxBreadcrumbs=5,this.appKey="",this.stack=[],this.bindOptions(t)}return t.prototype.push=function(t){return this.immediatePush(t)},t.prototype.immediatePush=function(t){return t.timestamp||(t.timestamp=Date.now()),this.stack.length>=this.maxBreadcrumbs&&this.shift(),this.stack.push(t),this.stack.sort((function(t,e){return t.timestamp-e.timestamp})),U(C+this.appKey,this.stack),this.stack},t.prototype.shift=function(){var t=this.stack.shift();return U(C+this.appKey,this.stack),void 0!==t},t.prototype.clear=function(){this.stack=[],U(C+this.appKey,[])},t.prototype.getStack=function(){return P(C+this.appKey)||[]},t.prototype.bindOptions=function(t){void 0===t&&(t={});var e=t.maxBreadcrumbs,n=t.appKey;m(e,"maxBreadcrumbs","Number")&&(this.maxBreadcrumbs=e),m(n,"appKey","String")&&(this.appKey=n)},t}();function K(){try{var t={name:"",version:"",shell:""},e=window,n=navigator.userAgent.toLowerCase();return t.name=-[1]?n.indexOf("firefox")>0?"firefox":n.indexOf("chrome")>0?"chrome":e.opera?"opera":e.openDatabase?"safari":"unkonw":"ie",t.version="ie"==t.name?n.match(/msie ([\d.]+)/)[1]:"firefox"==t.name?n.match(/firefox\/([\d.]+)/)[1]:"chrome"==t.name?n.match(/chrome\/([\d.]+)/)[1]:"opera"==t.name?n.match(/opera.([\d.]+)/)[1]:"safari"==t.name?n.match(/version\/([\d.]+)/)[1]:"0",t.shell=n.indexOf("360ee")>-1?"360Jisu":n.indexOf("360se")>-1?"360Safe":n.indexOf("se")>-1?"Sogou":n.indexOf("aoyou")>-1?"Aoyou":n.indexOf("theworld")>-1?"Theworld":n.indexOf("worldchrome")>-1?"TheworldChrome":n.indexOf("greenbrowser")>-1?"Green":n.indexOf("qq")>-1?"QQ":n.indexOf("baidu")>-1?"Baidu":n.indexOf("edg")>-1?"Edge":n.indexOf("firefox")>-1?"Firefox":n.indexOf("opr")>-1?"Opera":n.indexOf("chrome")>-1?"Chrome":"Nnknown",t.name+parseInt(t.version)}catch(t){return""}}var N={_device:"",_os:"",_os_version:"",_carrier:"",_mccmnc:"",_resolution:"",_density:"other",_locale:"",_app_version:"",_platform_version:"",_store:"",_deep_link:"",_device_type:"mobile",_channel:"",_scene:""},H=function(t){function e(e){var n=t.call(this)||this;return n.duration=6,n.checkTimer=null,n.lastedCheckTime=Date.now(),n.sessionId="",n.sessionTime="",n.cacheEndTimer=null,n.bindOptions(e),n.initSessionStartData(),n}return n(e,t),e.prototype.initSessionStartData=function(){var t;return this.sessionStartData={begin_session:"1",metrics:i({},N)},this.sessionStartData.metrics=i(i(i({},N),{_device:(null===navigator||void 0===navigator?void 0:navigator.platform)||"",_os:(t=navigator.userAgent,t.match(/MicroMessenger/i)||t.match(/QQ/i)||t.match(/Chrome/i)||t.match(/Opera/i)||t.match(/Firefox/i)||t.match(/Safari/i)?"pc":t.match(/android/i)?"Android":t.match(/iphone/i)||t.match(/ipad/i)?"iOS":"ActiveXObject"in window?"pc":""),_os_version:K(),_resolution:"".concat(null===screen||void 0===screen?void 0:screen.height,"x").concat(null===screen||void 0===screen?void 0:screen.width),_locale:(null===navigator||void 0===navigator?void 0:navigator.language)||""}),this.metrics),this.sessionStartData},e.prototype.start=function(){var t=P(this.cacheEnd);t&&(null==t?void 0:t.cache_end)&&this.emit("endCache",t),this.lastedCheckTime=Date.now(),this.startCheck(),this.emit("start",this.sessionStartData)},e.prototype.initSessionInfo=function(t){this.sessionId=t.session_id,this.sessionTime=t.session_time,this.clearCacheEndInfo(),this.intervalCacheEndInfo()},e.prototype.end=function(){var t={end_session:"1",session_duration:0,session_id:this.sessionId,session_time:this.sessionTime};t.session_duration=parseInt(((Date.now()-this.lastedCheckTime)/1e3).toString()),t.session_duration>6&&(t.session_duration=6),this.lastedCheckTime=Date.now(),this.clearCheckTimer(),this.clearCacheEndInfo(),this.emit("end",t)},e.prototype.startCheck=function(){this.clearCheckTimer(),this.intervalCheck()},e.prototype.intervalCheck=function(){var t=this;this.checkTimer=setInterval((function(){t.check()}),1e3*this.duration)},e.prototype.intervalCacheEndInfo=function(){var t=this;this.cacheEndTimer=setInterval((function(){t.cacheEndInfo()}),5e3)},e.prototype.cacheEndInfo=function(){var t={cache_end:"1",end_session:"1",session_duration:parseInt(((Date.now()-this.lastedCheckTime)/1e3).toString()),session_id:this.sessionId,session_time:this.sessionTime};U(this.cacheEnd,t)},e.prototype.clearCacheEndInfo=function(){this.cacheEndTimer&&(clearInterval(this.cacheEndTimer),this.cacheEndTimer=null),U(this.cacheEnd,"")},e.prototype.check=function(){var t={session_id:this.sessionId,session_time:this.sessionTime,session_duration:parseInt(((Date.now()-this.lastedCheckTime)/1e3).toString())};t.session_duration>6&&(t.session_duration=6),this.lastedCheckTime=Date.now(),this.emit("check",t)},e.prototype.clearCheckTimer=function(){this.checkTimer&&(clearInterval(this.checkTimer),this.checkTimer=null)},e.prototype.bindOptions=function(t){var e=t.duration,n=t.appVersion,r=t.appKey;this.cacheEnd=A+r,this.duration=e||this.duration,this.metrics=i(i({},this.metrics),{_app_version:n})},e}(E),z=function(){function t(t){this.capacity=50,this.circleQueue=new b(this.capacity),this.transport=t,this.reportHistoricalData()}return t.prototype.reportHistoricalData=function(){var t=JSON.parse(localStorage.getItem(F+this.transport.appKey));Array.isArray(t)&&this.circleQueue.setQueue(t)},t.prototype.deleteTaskForQueue=function(t){this.circleQueue.deleteForTcpId(t)},t.prototype.shiftTaskForQueue=function(t,e){var n=this;return this.circleQueue.unshift(t),new Promise((function(i,r){var o=t.tcpId;n.circleQueue.refreshStatusForTcpId(o,"REPORTING"),n.transport.send(t,e).then((function(t){n.deleteTaskForQueue(o),i(t)})).catch((function(t){n.circleQueue.refreshStatusForTcpId(o,"REPORT_FAIL"),r(t)}))})).finally((function(){U(F+n.transport.appKey,n.circleQueue.getQueue()),n.clearTaskForQueue(e)}))},t.prototype.clearTaskForQueue=function(t){var e=this;(this.circleQueue.getQueue()||[]).map((function(n){if("REPORTING"===n.reportStatus)return n;var i=n.tcpId;return e.circleQueue.refreshStatusForTcpId(i,"REPORTING"),e.transport.send(n,t).then((function(){e.deleteTaskForQueue(i),U(F+e.transport.appKey,e.circleQueue.getQueue())})).catch((function(){e.circleQueue.refreshStatusForTcpId(i,"REPORT_FAIL")})),n}))},t.prototype.clearStoreQueue=function(){this.circleQueue.clear(),U(F+this.transport.appKey,this.circleQueue.getQueue())},t}(),M=function(t){function e(e){var n=t.call(this)||this;return t.prototype.bindOptions.call(n,e),n}return n(e,t),e.prototype.bindOptions=function(e){t.prototype.bindOptions.call(this,e)},e}(x),J="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};function L(t,e,n){return t(n={path:e,exports:{},require:function(t,e){return W(null==e&&n.path)}},n.exports),n.exports}function W(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var G={},V=L((function(t,e){var n;t.exports=n=n||function(t,e){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==J&&J.crypto&&(n=J.crypto),!n)try{n=G}catch(t){}var i=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(t){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(t){}}throw new Error("Native crypto module could not be used to get secure random number.")},r=Object.create||function(){function t(){}return function(e){var n;return t.prototype=e,n=new t,t.prototype=null,n}}(),o={},s=o.lib={},a=s.Base={extend:function(t){var e=r(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},c=s.WordArray=a.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||h).stringify(this)},concat:function(t){var e=this.words,n=t.words,i=this.sigBytes,r=t.sigBytes;if(this.clamp(),i%4)for(var o=0;o<r;o++){var s=n[o>>>2]>>>24-o%4*8&255;e[i+o>>>2]|=s<<24-(i+o)%4*8}else for(var a=0;a<r;a+=4)e[i+a>>>2]=n[a>>>2];return this.sigBytes+=r,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=a.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],n=0;n<t;n+=4)e.push(i());return new c.init(e,t)}}),u=o.enc={},h=u.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var o=e[r>>>2]>>>24-r%4*8&255;i.push((o>>>4).toString(16)),i.push((15&o).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new c.init(n,e/2)}},p=u.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var o=e[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(o))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new c.init(n,e)}},l=u.Utf8={stringify:function(t){try{return decodeURIComponent(escape(p.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return p.parse(unescape(encodeURIComponent(t)))}},f=s.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=l.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n,i=this._data,r=i.words,o=i.sigBytes,s=this.blockSize,a=o/(4*s),u=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*s,h=t.min(4*u,o);if(u){for(var p=0;p<u;p+=s)this._doProcessBlock(r,p);n=r.splice(0,u),i.sigBytes-=h}return new c.init(n,h)},clone:function(){var t=a.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});s.Hasher=f.extend({cfg:a.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new d.HMAC.init(t,n).finalize(e)}}});var d=o.algo={};return o}(Math)})),X=L((function(t,e){var n;t.exports=(n=V,function(t){var e=n,i=e.lib,r=i.WordArray,o=i.Hasher,s=e.algo,a=[],c=[];!function(){function e(e){for(var n=t.sqrt(e),i=2;i<=n;i++)if(!(e%i))return!1;return!0}function n(t){return 4294967296*(t-(0|t))|0}for(var i=2,r=0;r<64;)e(i)&&(r<8&&(a[r]=n(t.pow(i,.5))),c[r]=n(t.pow(i,1/3)),r++),i++}();var u=[],h=s.SHA256=o.extend({_doReset:function(){this._hash=new r.init(a.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],o=n[2],s=n[3],a=n[4],h=n[5],p=n[6],l=n[7],f=0;f<64;f++){if(f<16)u[f]=0|t[e+f];else{var d=u[f-15],y=(d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3,v=u[f-2],m=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;u[f]=y+u[f-7]+m+u[f-16]}var g=i&r^i&o^r&o,_=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),w=l+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&h^~a&p)+c[f]+u[f];l=p,p=h,h=a,a=s+w|0,s=o,o=r,r=i,i=w+(_+g)|0}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0,n[5]=n[5]+h|0,n[6]=n[6]+p|0,n[7]=n[7]+l|0},_doFinalize:function(){var e=this._data,n=e.words,i=8*this._nDataBytes,r=8*e.sigBytes;return n[r>>>5]|=128<<24-r%32,n[14+(r+64>>>9<<4)]=t.floor(i/4294967296),n[15+(r+64>>>9<<4)]=i,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=o.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=o._createHelper(h),e.HmacSHA256=o._createHmacHelper(h)}(Math),n.SHA256)}));function $(t,e){var n=w(t),r=X(n+=e).toString();return i(i({},t),{checksum256:r})}function Y(t,e,n,i,r){try{Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),i&&(this.request=i),r&&(this.response=r)}catch(t){console.error("AxiosError",t)}}var Z="fire-bird-browser-sdk",tt="dist/browser.min.js",et="dist/browser.esm.js",nt="dist/browser.d.ts",it=["dist"],rt={type:"git",url:"git+https://github.com/openhnteam/analytics-sdk-js.git"},ot={url:"https://github.com/openhnteam/analytics-sdk-js/issues"},st={access:"public",registry:"http://registry.npmjs.org"},at=["firebirdjs","sdk"],ct={},ut={name:Z,version:"1.0.0",description:"火鹏运营平台web端sdk",author:"ly",license:"Apache-2.0",main:tt,module:et,types:nt,files:it,repository:rt,bugs:ot,publishConfig:st,keywords:at,dependencies:ct},ht=Object.freeze({__proto__:null,name:Z,version:"1.0.0",description:"火鹏运营平台web端sdk",author:"ly",license:"Apache-2.0",main:tt,module:et,types:nt,files:it,repository:rt,bugs:ot,publishConfig:st,keywords:at,dependencies:ct,default:ut}),pt=(null==ht?void 0:"1.0.0")||"1.0.0",lt=function(t){function e(e){var n=t.call(this)||this;return t.prototype.bindOptions.call(n,e),n.bindOptions(e),n}return n(e,t),e.prototype.post=function(t,e){return new Promise((function(n,i){var r,o=w(t);(r={url:e,data:o,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"}},new Promise((function(t,e){r.data;var n=r.headers,i=new XMLHttpRequest;function o(){if(i){var e={};"getAllResponseHeaders"in i&&i.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach((function(t){var n=t.split(": "),i=n.shift(),r=n.join(": ");e[i]=r}));var n={data:JSON.parse(i.responseText),status:i.status,statusText:i.statusText,headers:e,config:r,request:i};t(n.data),i=null}}if(i.open(r.method&&r.method.toUpperCase()||"GET",function(t,e){try{var n=[];if(e)for(var i in e)n.push(i+"="+e[i]);return t+(n.length?"?"+n.join("&"):"")}catch(t){return""}}(r.url,r.params),!0),i.timeout=r.timeout,i.onreadystatechange=function(){i&&4===i.readyState&&setTimeout(o)},i.onerror=function(){e(new Y("Network Error","ERR_NETWORK",r,i,null)),i=null},i.ontimeout=function(){var t=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";r.timeoutErrorMessage&&(t=r.timeoutErrorMessage),e(new Y(t,"ECONNABORTED",r,i,null)),i=null},"setRequestHeader"in i&&n)for(var s in n)i.setRequestHeader(s,n[s].toString());else i.setRequestHeader("Content-Type","application/json");i.send(r.data)})).catch((function(t){console.error("xhrAdapter",t)}))).then((function(t){t.success?n(t.data):i(t)})).catch((function(t){i(t)}))}))},e.prototype.navigatorPost=function(t,e){return fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:w(t),keepalive:!0})},e.prototype.navigatorToServer=function(t,e){return this.navigatorPost(t.data,e)},e.prototype.sendNavigator=function(t){var e=this.host;if(e)return this.navigatorToServer(t,e);console.error("host is empty,pass in when initializing please")},e.prototype.sendToServer=function(t,e){return this.post(t.data,e)},e.prototype.handleTransportData=function(t){var e=this.getBaseData(),n=i(i(i(i({},e),this.authInfo),t),{app_user_id:this.appUserId,sdk_version:pt,sdk_name:"browser"});return t.begin_session&&(delete n.session_id,delete n.session_time),n.metrics&&(n.metrics._scene=this.scene,n.metrics=JSON.stringify(n.metrics)),{data:$(n,this.salt),tcpId:g(),reportStatus:"NOT_REPORT"}},e.prototype.bindOptions=function(e){if(t.prototype.bindOptions.call(this,e),!(null==e?void 0:e.appUserId)){var n=e.configReportXhr,i=e.appUserId;m(n,"configReportXhr","Function")&&(this.configReportXhr=n),m(i||"","appUserId","String")&&(this.appUserId=i||"")}},e}(T),ft=function(t){function e(e){var n=this;return e.deviceId=function(t){try{return(e=q(O+t))||(e=g(),U(O+t,e)),(null==e?void 0:e.indexOf('"'))>-1&&(e=e.replace(/"/g,""),U(O+t,e)),e}catch(n){var e=g();return U(O+t,e),e}}(e.appKey),e.channel="Browser",(n=t.call(this,e)||this).options=new M(e),n.eventBreadcrumb=new j(e),n.transport=new lt(e),n.transportQueue=new z(n.transport),n.session=new H(e),n.init(),n}return n(e,t),e.prototype.init=function(){var t=this;try{if(this.bindSessionEvent(),this.hasAuthStore()){var e=q(B+this.options.appKey);this.transport.setAuthInfo(e),this.startSession()}else this.auth().then((function(){t.startSession()})).catch((function(e){console.error("auth",e),t.session.startCheck()}))}catch(t){console.error("init",t)}},e.prototype.hasAuthStore=function(){var t=q(B+this.options.appKey);return!!(null==t?void 0:t.device_no)},e.prototype.checkAuthStatus=function(){return this.transport.authInfo},e.prototype.auth=function(){var t=this,e=$({app_key:this.options.appKey,device_id:this.options.deviceId,install_channel:this.options.channel},this.options.salt);return new Promise((function(n,i){var r=t.options.host+D;t.transport.post(e,r).then((function(e){var i={device_no:e.device_no,create_time:e.create_time,install_channel:e.install_channel};U(B+t.options.appKey,i),t.setAuthInfo(i),n(e)})).catch((function(t){i(t)}))}))},e.prototype.setAuthInfo=function(t){this.transport.setAuthInfo(t)},e.prototype.bindSessionEvent=function(){var t=this;this.session.on("start",(function(e){var n=t.transport.handleTransportData(e);t.transportQueue.shiftTaskForQueue(n,Q).then((function(e){var n={session_id:e.session_id,session_time:e.session_time};t.session.initSessionInfo(n)}))})),this.session.on("check",(function(e){var n=t.transport.handleTransportData(e);t.checkAuthStatus()?(t.transportQueue.shiftTaskForQueue(n,Q),t.trackEventFocus()):t.auth().then((function(){t.transportQueue.shiftTaskForQueue(n,Q)})).catch((function(t){console.error("check",t)}))})),this.session.on("end",(function(e){var n=t.transport.handleTransportData(e);t.checkAuthStatus()&&t.transportQueue.shiftTaskForQueue(n,Q).then((function(){t.transportQueue.clearStoreQueue(),t.session.clearCacheEndInfo()}))})),this.session.on("endCache",(function(e){var n=t.transport.handleTransportData(e);t.transportQueue.shiftTaskForQueue(n,Q).then((function(){t.session.clearCacheEndInfo()})),t.trackEventFocus()}))},e.prototype.startSession=function(){this.checkAuthStatus()&&this.session.start()},e.prototype.endSession=function(){this.trackEventFocus(),this.session.end()},e.prototype.trackEventFocus=function(){var t=this,e=this.eventBreadcrumb.getStack();if(e.length){var n={events:JSON.stringify(e)},i=this.transport.handleTransportData(n);this.transportQueue.shiftTaskForQueue(i,Q).then((function(e){t.eventBreadcrumb.clear()}))}},e.prototype.trackEvent=function(t){var e,n,i=this;if(this.eventBreadcrumb.push(t),((null===(n=null===(e=this.eventBreadcrumb)||void 0===e?void 0:e.getStack())||void 0===n?void 0:n.length)||0)>=this.eventBreadcrumb.maxBreadcrumbs){var r=this.eventBreadcrumb.getStack(),o={events:JSON.stringify(r)},s=this.transport.handleTransportData(o);this.transportQueue.shiftTaskForQueue(s,Q).then((function(){i.eventBreadcrumb.clear()}))}},e.prototype.setUser=function(t){t&&(U(R+this.options.appKey,t),this.options.bindOptions({appUserId:t}),this.transport.bindOptions({appUserId:t}))},e}(k),dt=null;return{init:function(t){void 0===t&&(t={});try{return dt&&dt instanceof ft?dt:c(null==t?void 0:t.appKey)||c(null==t?void 0:t.salt)?console.warn("appKey & salt is empty"):dt=new ft(t)}catch(t){console.error("init is error",t)}},trackEvent:function(t){try{return dt?dt.trackEvent(t):void console.warn("browser no a instance")}catch(t){console.error("trackEvent is error",t)}},setUser:function(t){try{return dt?dt.setUser(t):void console.warn("browser no a instance")}catch(t){console.error("setUser is error",t)}},endSession:function(){try{return dt?dt.endSession():void console.warn("browser no a instance")}catch(t){console.error("endSession is error",t)}},startSession:function(){try{return dt?dt.startSession():void console.warn("browser no a instance")}catch(t){console.error("endSession is error",t)}}}}();
